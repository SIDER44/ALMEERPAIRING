<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ALMEER XMD Ultimate Panel</title>

<style>
body{
margin:0;
font-family:'Segoe UI',sans-serif;
overflow:hidden;
background:linear-gradient(-45deg,#ff00cc,#3333ff,#00ffcc,#ff6600);
background-size:400% 400%;
animation:bg 12s ease infinite;
color:white;
text-align:center;
}

@keyframes bg{
0%{background-position:0% 50%;}
50%{background-position:100% 50%;}
100%{background-position:0% 50%;}
}

canvas#particles{
position:fixed;
top:0;
left:0;
z-index:-1;
}

.container{
margin:40px auto;
padding:30px;
max-width:500px;
border-radius:20px;
background:rgba(0,0,0,0.65);
backdrop-filter:blur(15px);
box-shadow:0 0 40px cyan;
animation:float 4s ease-in-out infinite;
}

@keyframes float{
0%{transform:translateY(0px);}
50%{transform:translateY(-12px);}
100%{transform:translateY(0px);}
}

h1{text-shadow:0 0 15px cyan;}

input{
width:90%;
padding:12px;
border-radius:10px;
border:none;
margin:10px 0;
text-align:center;
font-size:16px;
}

button{
width:95%;
padding:12px;
border-radius:10px;
border:none;
font-weight:bold;
cursor:pointer;
background:linear-gradient(45deg,#ff00cc,#00ffcc);
color:white;
font-size:16px;
transition:0.3s;
}

button:hover{transform:scale(1.08);}

#result{margin-top:15px;}

.pairing-code{
font-size:22px;
font-weight:bold;
margin-top:10px;
background:rgba(255,255,255,0.2);
padding:10px;
border-radius:10px;
}

.loader{
border:4px solid rgba(255,255,255,0.3);
border-top:4px solid cyan;
border-radius:50%;
width:30px;
height:30px;
margin:15px auto;
animation:spin 1s linear infinite;
}

@keyframes spin{100%{transform:rotate(360deg);}}

/* Visualizer */
#visualizer{
display:flex;
justify-content:center;
align-items:flex-end;
height:60px;
margin-top:20px;
}

.bar{
width:5px;
background:cyan;
margin:0 2px;
animation:bounce 1s infinite ease-in-out;
}

@keyframes bounce{
0%,100%{height:10px;}
50%{height:50px;}
}
</style>
</head>

<body>

<canvas id="particles"></canvas>

<div class="container">
<h1>üöÄ ALMEER XMD PANEL</h1>
<p>Enter License Key First</p>

<input type="text" id="license" placeholder="Enter License Key">
<button onclick="verifyLicense()">Verify License</button>

<div id="licenseStatus"></div>

<div id="pairSection" style="display:none;">
<p>Enter WhatsApp Number</p>
<input type="text" id="phone" placeholder="e.g 2547XXXXXXXX">
<button onclick="pair()">Generate Pairing</button>
</div>

<div id="loading"></div>
<div id="result"></div>
<canvas id="qrCanvas" style="display:none;"></canvas>

<div id="visualizer"></div>

<audio id="bgMusic" loop>
<source src="song.mp3" type="audio/mpeg">
</audio>

<button onclick="toggleMusic()" style="margin-top:15px;">
üéµ Play / Pause Music
</button>

</div>

<script>
// PARTICLES
const canvas=document.getElementById("particles");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let particles=[];
for(let i=0;i<80;i++){
particles.push({
x:Math.random()*canvas.width,
y:Math.random()*canvas.height,
size:Math.random()*3,
speed:Math.random()*1
});
}
function animate(){
ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.fillStyle="rgba(255,255,255,0.5)";
particles.forEach(p=>{
ctx.beginPath();
ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
ctx.fill();
p.y+=p.speed;
if(p.y>canvas.height)p.y=0;
});
requestAnimationFrame(animate);
}
animate();

// MUSIC
const music=document.getElementById("bgMusic");
document.addEventListener("click",()=>{music.play().catch(()=>{});},{once:true});
function toggleMusic(){
if(music.paused)music.play();
else music.pause();
}

// VISUALIZER
const visualizer=document.getElementById("visualizer");
for(let i=0;i<30;i++){
const bar=document.createElement("div");
bar.classList.add("bar");
bar.style.animationDelay=Math.random()+"s";
visualizer.appendChild(bar);
}

// LICENSE VERIFY
async function verifyLicense(){
const license=document.getElementById("license").value.trim();
if(!license)return alert("Enter license key");

const res=await fetch('/verify-license',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({license})
});
const data=await res.json();

if(data.success){
document.getElementById("licenseStatus").innerHTML="<span style='color:lime'>License Verified ‚úÖ</span>";
document.getElementById("pairSection").style.display="block";
}else{
document.getElementById("licenseStatus").innerHTML="<span style='color:red'>Invalid or Used License ‚ùå</span>";
}
}

// PAIR
async function pair(){
const phone=document.getElementById('phone').value.trim();
const result=document.getElementById('result');
const loading=document.getElementById('loading');
const qrCanvas=document.getElementById('qrCanvas');

if(!phone)return alert("Enter phone number!");

result.innerHTML="";
qrCanvas.style.display="none";
loading.innerHTML='<div class="loader"></div>';

try{
const response=await fetch('/pair',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({phoneNumber:phone})
});
const data=await response.json();
loading.innerHTML="";

if(data.success){
result.innerHTML="Scan QR Below:";
if(data.qr){
const ctx2=qrCanvas.getContext("2d");
const img=new Image();
img.onload=()=>{
qrCanvas.width=img.width;
qrCanvas.height=img.height;
ctx2.drawImage(img,0,0);
qrCanvas.style.display="block";
};
img.src=data.qr;
}
}else{
result.innerHTML="Error pairing.";
}
}catch(e){
loading.innerHTML="";
result.innerHTML="Server error.";
}
}
</script>

</body>
</html>